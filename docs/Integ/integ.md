---
title: Интеграция
sidebar_position: 1
---

# Интеграции: Проектируем асинхронное взаимодействие

## Описание

В системе используется **асинхронное взаимодействие** для обновления оценок продуктов. Когда пользователь оставляет оценку продукту, инициируется процесс обновления общей оценки. 

**Как это работает**:
1. Событие о новой оценке и отзыве отправляется в **Apache Kafka**.
2. Kafka передаёт сообщение в тему, подписанную на сервис обновления оценки.
3. Сервис обрабатывает сообщения асинхронно, выполняя вычисления и обновления базы данных, не задерживая пользователя.

Такой подход обеспечивает гибкость и масштабируемость взаимодействия между компонентами системы.

## Причины выбора Kafka

1. **Характер взаимодействия**: Подходит для событийно-ориентированных систем.
2. **Платформы и стек**: Лёгкая интеграция с Java, Python, Go и другими языками.
3. **Надёжность**: Гарантированная доставка сообщений (*at-least-once*).
4. **Масштабируемость**: Поддержка миллионов событий в секунду.

---

## Схема данных (Avro)

Асинхронное взаимодействие описывается с помощью **Apache Avro**:

```json
{
  "type": "record",
  "name": "ProductRating",
  "namespace": "com.example",
  "fields": [
    {
      "name": "productId",
      "type": "string",
      "doc": "Уникальный идентификатор товара, который оценивается."
    },
    {
      "name": "userId",
      "type": "string",
      "doc": "Уникальный идентификатор пользователя, оставившего оценку."
    },
    {
      "name": "rating",
      "type": "int",
      "doc": "Оценка, оставленная пользователем, в пределах от 1 до 5."
    },
    {
      "name": "dateTime",
      "type": {
        "type": "string",
        "format": "date-time"
      },
      "doc": "Дата и время, когда была оставлена оценка, в формате ISO 8601."
    }
  ]
}
